webpackJsonp([39,76],{169:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n){for(var i=new PIXI.Container,o=new PIXI.filters.ColorMatrixFilter,r=a||!1,s=n||{addArrow:!1,type:"horizontal",scale:1},d=new PIXI.Container,h=0;h<3;++h){var l=h+1,c=PIXI.Sprite.fromFrame("TAP_1"+l);c.x=-c.width/2,c.y=-c.height/2;var p=new PIXI.Container;p.addChild(c),d.addChild(p)}var v=0;if(s.direction)switch(s.direction){case"top":v=-Math.PI/2;break;case"bottom":v=Math.PI/2;break;case"left":v=Math.PI;break;case"right":v=0;break;default:v=0}d.filters=[o];for(var f=0;f<d.children.length;f++){var T=d.children[f];T.scale.x=T.scale.y=2,f<2&&D(T,.75*f)}if(i.addChild(d),s.addArrow){var u,N;if(s.direction){u=PIXI.Sprite.fromFrame("oneArrow"),N=new PIXI.extras.MovieClip([u]);var g=s.scale?s.scale:1;N.scale.x=N.scale.y=g,N.pivot={x:0,y:N.height/2},N.rotation=v}else{u=PIXI.Sprite.fromFrame("NBarrow"),(N=new PIXI.extras.MovieClip([u])).pivot={x:N.width/2,y:N.height/2};var m=s.scale?s.scale:1;N.scale.x=N.scale.y=m,"horizontal"!==(s.type?s.type:"horizontal")&&(N.rotation=Math.PI/2)}i.addChild(N),i.arrow=N,i.addEventListener("hideArrow",function(){N.alpha=0,N.visible=!1}),i.addEventListener("showArrow",function(){N.alpha=1,N.visible=!0})}d.alpha=.4;var x=new PIXI.Graphics;function D(e,t){TweenMax.to(e,1.5,{delay:t,alpha:0,repeat:-1}),TweenMax.to(e.scale,1.5,{x:5,y:5,delay:t,repeat:-1})}return x.beginFill(16776960,0),x.drawRect(-50,-50,100,100),i.addChild(x),i.addEventListener(MouseEvent.MOUSE_OVER,function(){d.alpha=.6}),i.addEventListener(MouseEvent.MOUSE_OUT,function(){d.alpha=.4}),i.addEventListener(TouchEvent.TOUCH_BEGIN,function(){i.emit(i.event.TAP),!r&&i.parent&&i.parent.removeChild(i)}),i.x=e,i.y=t,i.setColor=function(e){var t=e>>16,a=e>>8&255,n=255&e;o._loadMatrix([t,0,0,0,0,0,a,0,0,0,0,0,n,0,0,0,0,0,255,0],!1),d.filters=[o]},i.setRotation=function(e){i.rotation=e},i.showAllDir=function(){if(s.direction)for(var e=0;e<3;e++){var t=new PIXI.Container;t.addChild(PIXI.Sprite.fromFrame("oneArrow")),i.addChild(t),t.pivot={x:0,y:N.height/2},t.rotation=Math.PI/2*(e+1)}else{var a=new PIXI.Container;a.addChild(PIXI.Sprite.fromFrame("NBarrow")),i.addChild(a),a.pivot={x:N.width/2,y:N.height/2},a.rotation=i.rotation+Math.PI/2}},i.event={TAP:"pointTap",HIDEARR:"hideArrow",SHOWARR:"showArrow"},instance.info&&instance.info.newLayOut&&i.scale.set(.6,.6),i}},247:function(e,t,a){"use strict";var n=r(a(521)),i=r(a(520)),o=r(a(169));function r(e){return e&&e.__esModule?e:{default:e}}nb.substance0112=extendsClass(ScienceMain,{frame0:function(){var e=this,t=[Math.PI/2,3*Math.PI/2];instance.viewStack.NBONOFF.visible=!1,n.default.apply(e);for(var a=1;a<3;a++){var r=e["step"+a],s=r.compass;NBDrag.addDrag(s),s.addEventListener(NBDrag.event.START_DRAG,function(){instance.NBDownTip.hideTip()}),nb.compass.apply(s,[{NPole:r.ref0,SPole:r.ref1,offsetRotation:t[a-1]},500]);var d=(0,o.default)(0,0);s.addChild(d)}e.step0.draged=!0,e.timeline.addEventListener(i.default.event.CLICK_NODE,function(t){instance.NBDownTip.hideTip();var a=e["step"+t.index];a.draged||(a.draged=!0)}),e.onUpdate=function(){e.step1.compass.render(),e.step2.compass.render()}},start:function(){this.bindScriptToSprite(this.frame0,"frame0")},info:{experimentImport:"1820年，丹麦科学家奥斯特在一次实验中，偶然让通电的导线靠近指南针，发现了一个奇怪的现象，是什么现象呢？我们也来做一做这样的实验吧。",labName:"铁钉电磁铁的南北极",CONCLUSION:"通电导线和通电线圈能够使指南针发生偏转。",noTitle:!1,newLayOut:!0,bgColor:"#F3E6CF"},const:{START_ROTATION:Math.PI/2},event:{}}),nb.compass=function(e,t){var a=0,n=NaN,i=$s(400);if(t=t||$s(1e3),null==e)throw"配置conf";if(void 0===e.NPole)throw"请配置NPole";if(void 0===e.SPole)throw"请配置SPole";this.render=function(){var o=this.toGlobal({x:0,y:0}),r=e.NPole.toGlobal({x:0,y:0}),s=e.SPole.toGlobal({x:0,y:0}),d=NBPoint.distance(o,r),h=NBPoint.distance(o,s);e.NPole.alpha=0,e.SPole.alpha=0;var l=Math.pow(d,3),c=(o.x-r.x)/l,p=(o.y-r.y)/l,v=Math.pow(h,3),f=(s.x-o.x)/v,T=(s.y-o.y)/v,u=1,N={x:.5*(r.x+s.x),y:.5*(r.y+s.y)},g=NBPoint.distance(o,N);g>i&&(u=(t-(g-i))/t*((t-(g-i))/t),g>t+i&&(u=0));var m=Math.atan2(p+T,c+f);m-n>2*Math.PI*.51?m-=2*Math.PI:m-n<2*-Math.PI*.51&&(m+=2*Math.PI),n=m;var x=(m+e.offsetRotation)*u,D=this.point.rotation;D-x>2*Math.PI*.51?D=this.point.rotation-=2*Math.PI:D-x<2*-Math.PI*.51&&(D=this.point.rotation+=2*Math.PI),a=.9*(a+.1*(x-D));var w=this.point.rotation+a;this.point.rotation=w}},e.exports=nb.substance0112},285:function(e,t,a){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}}(a(169));a(247),nb.substance0019=extendsClass(ScienceMain,{frame0:function(){var e,t,a,i=this,o=0,r=[],s=i.megnet,d=i.bar.progress,h=0;i.complete_1=!1,NBDrag.addDrag(i.megnet,{x:0,y:i.megnet.height/2,height:900-i.megnet.height/2,width:1225}),NBDrag.addDrag(i.nail);var l=(0,n.default)(0,0,!0),c=(0,n.default)(0,0,!0);i.nail.nailPoint=c,s.addChild(l),s.megnetPoint=l,i.autoBtn.interactive=!1,i.autoBtn.alpha=0;var p=0,v=0;this.onUpdate=function(){for(var e=0;e<u.length;e++){var t=u[e];t.hit||5*(r.length+1)<=Math.abs(o)&&r.length<7&&i.nail.hitTest(t)&&(t.hit=i.nail,t.bindX=70-150*Math.random(),r.push(t),i.complete_1=!0)}if(5*r.length>Math.abs(o)){var a=r.pop();a&&(delete a.hit,TweenMax.to(a,.3,{y:a.y+$s(50),rotation:Math.random()}))}for(var n=0;n<u.length;n++){var s=u[n];s.hit&&(s.x=i.nail.x+s.bindX,s.y=i.nail.y-$s(2))}var h=1-i.bar.txt.text/10;h<=0&&(h=0,i.bar.visible=!1,i.autoBtn.interactive=!1,i.nail.hasCI=!0,nb.GlobalEffect.fadeOut(i.autoBtn)),d.scale.x=h};var f=[];i.megnet.addEventListener(NBDrag.event.DRAG_MOVE,function(){t=e,e=a,i.megnet.hitTest(i.nail.refleft)&&(a=1,v=1,h=1,p=1,i.megnet.hitNail=!0),i.megnet.hitTest(i.nail.refright)&&(a=2,v=2,h=1,p=2,i.megnet.hitNail=!0),e>t?(o++,f.push(1)):e<t&&(f.push(0),o--),i.megnet.hitTest(i.nail.nail)?i.autoBtn.alpha||TweenMax.to(i.autoBtn,1,{alpha:1,onComplete:function(){i.autoBtn.interactive=!0}}):(e=NaN,t=NaN,a=NaN),i.bar.txt.text>Math.abs(o)&&instance.NBDownTipsError.showTip("请沿同一方向摩擦"),f.length>=2&&(f[f.length-1]===f[f.length-2]?instance.NBDownTipsError.hideTip():instance.NBDownTipsError.showTip("请沿同一方向摩擦")),0==+i.bar.txt.text&&1===Math.abs(o)&&(i.addDir=v),i.bar.txt.text=Math.abs(o)}),i.megnet.addEventListener(NBDrag.event.START_DRAG,function(){s.removeChild(l),f.length>=2&&(f=[f[f.length-2],f[f.length-1]])}),s.addEventListener(NBDrag.event.STOP_DRAG,function(){s.hitTest(i.nail)||0!==h||(s.addChild(l),instance.NBDownTip.showTip("拖动磁铁在磁针上滑动，使磁针有磁性")),p&&i.autoBtn.addEventListener(TouchEvent.TAP,function(){i.nail.interactive=s.interactive=!1,instance.NBDownTipsError.hideTip(),instance.NBDownTip.hideTip(),function e(t,a){var n=void 0;var r=void 0;1===i.addDir?(n=a.x+a.width/2,r=a.x-a.width/2):2===i.addDir&&(n=a.x-a.width/2,r=a.x+a.width/2);t.y=a.y+t.height/5;TweenMax.to(t,.3,{x:n,y:a.y,ease:Sine.easeInOut,onComplete:function(){TweenMax.to(t,.3,{x:r,ease:Sine.easeInOut,onComplete:function(){TweenMax.to(t,.1,{y:a.y+250,ease:Sine.easeInOut,onComplete:function(){TweenMax.to(t,.3,{x:n,ease:Sine.easeInOut,onComplete:function(){if(!(i.bar.txt.text<10))return i.bar.txt.text=10,s.interactive=!0,i.nail.interactive=!0,void TweenMax.to(s,.5,{y:1e3,x:1100,ease:Sine.easeInOut,onComplete:function(){i.nail.hasCI=!0,instance.NBDownTip.showTip("用磁针吸引小铁钉验证磁针有磁性"),i.nail.addChild(c),i.nail.Point=c,o=10}});i.bar.txt.text++,e(t,a)}})}})}})}})}(s,i.nail),nb.GlobalEffect.fadeOut(i.autoBtn)}),1===h&&!i.complete_1&&i.nail.hasCI&&(i.nail.addChild(c),instance.NBDownTip.showTip("用磁针吸引小铁钉验证磁针有磁性"))}),s.addEventListener(NBDrag.event.START_DRAG,function(){instance.NBDownTip.hideTip(),i.complete_1&&instance.NBDownTipsError.showTip("步骤一已完成")}),i.nail.addEventListener(NBDrag.event.START_DRAG,function(){i.addChild(i.nail),instance.NBDownTip.hideTip(),i.nail.Point&&i.nail.removeChild(i.nail.Point),i.complete_1&&instance.NBDownTipsError.showTip("步骤一已完成"),i.nail.nailPoint&&i.nail.removeChild(c)}),i.nail.addEventListener(NBDrag.event.STOP_DRAG,function(){0===h&&(instance.NBDownTip.showTip("拖动磁铁在磁针上滑动，使磁针有磁性"),i.megnet.addChild(l)),i.complete_1&&instance.NBStepsShow(!0,1),1===h&&!i.complete_1&&i.nail.hasCI&&(i.nail.addChild(c),instance.NBDownTip.showTip("用磁针吸引小铁钉验证磁针有磁性"))});for(var T=instance.const.rect||{x:$s(300),y:$s(950),w:$s(800),h:$s(100)},u=[],N=0;N<60;N++){var g=new PIXI.Sprite.fromFrame("pin.png");g.x=T.x+T.w*Math.random(),g.y=T.y+T.h*Math.random(),g.anchor.x=.5,g.anchor.y=.5,g.rotation=50*(.5-Math.random())/180*Math.PI,this.addChild(g),u.push(g)}i.area.x=T.x,i.area.y=T.y,i.area.width=T.w,i.area.height=T.h,i.area.alpha=0,i.area.addEventListener(TouchEvent.TAP,function(){i.megnet.hitNail||instance.NBDownTip.showTip("拖动磁铁在磁针上滑动，使磁针有磁性"),i.nail.hasCI&&!i.complete_1&&instance.NBDownTip.showTip("用磁针吸引小铁钉验证磁针有磁性")})},frame1:function(){instance.NBDownTip.showTip("将磁针放入卡纸中");var e=this;e.left.alpha=e.right.alpha=0,e.paper.fish.alpha=0,NBDrag.addDrag(e.compass),NBDrag.addDrag(e.nail),NBDrag.addDrag(e.N),NBDrag.addDrag(e.S);var t=e.N.x,a=e.N.y,i=e.S.x,o=e.S.y,r=e.refn.x,s=e.refs.x,d=e.nail,h=(0,n.default)(160,0,!0),l=(0,n.default)(0,0,!0),c=(0,n.default)(0,0,!0);function p(){instance.NBDownTip.hideTip(),e.N.removeChild(c),e.stepComplete0&&e.stepComplete1&&e.compass.hit&&(instance.NBDownTipsError.showTip("步骤二已完成"),e.complete=!0,instance.NBStepsShow(!0,2))}d.addChild(h),nb.compass.apply(e.compass,[{NPole:e.nail.ref0,SPole:e.nail.ref1,offsetRotation:instance.const.START_ROTATION},500]),this.onUpdate=function(){e.compass.render()},d.addEventListener(NBDrag.event.START_DRAG,function(){instance.NBDownTip.hideTip(),d.removeChild(h)}),d.addEventListener(NBDrag.event.STOP_DRAG,function(){d.hitTest(e.paper)&&NBPoint.distance(e.nail,e.paper)<instance.const.DISTANCE?TweenMax.to(e.nail,.5,{x:e.paper.x-$s(127),y:e.paper.y-$s(9),onComplete:function(){TweenMax.to(e.paper.fish,.5,{alpha:1}),e.nail.alpha=0,NBDrag.removeDrag(e.nail),e.stepComplete0=!0,e.compass.hitTest(e.left)||e.compass.hitTest(e.right)?(instance.NBDownTip.showTip("判断磁铁的南北极并拖动N/S进行标记"),e.N.addChild(c),e.N.Point=c):(instance.NBDownTip.showTip("拖拽指南针到卡纸左右,进行判断磁铁"),e.compass.addChild(l),e.compass.compassPoint=l)}}):(d.addChild(h),instance.NBDownTip.showTip("将磁针放入卡纸中"))}),e.compass.addEventListener(NBDrag.event.START_DRAG,function(){instance.NBDownTip.hideTip(),e.compass.removeChild(l),p()}),e.compass.addEventListener(NBDrag.event.STOP_DRAG,function(){(e.compass.hitTest(e.left)||e.compass.hitTest(e.right))&&(e.compass.hit=!0),e.stepComplete0?e.stepComplete0&&(e.compass.hitTest(e.left)||e.compass.hitTest(e.right)||e.complete||e.compass.hit?e.stepComplete1?p():(instance.NBDownTip.showTip("判断磁铁的南北极并拖动N/S进行标记"),e.N.addChild(c),e.N.Point=c):(instance.NBDownTip.showTip("拖拽指南针到卡纸左右,进行判断磁铁"),e.compass.addChild(l))):instance.NBDownTip.showTip("将磁针放入卡纸中")}),e.paper.addEventListener(TouchEvent.TAP,function(){e.stepComplete0||instance.NBDownTip.showTip("将磁针放入卡纸中")}),e.N.addEventListener(NBDrag.event.START_DRAG,p),e.S.addEventListener(NBDrag.event.START_DRAG,p),e.S.addEventListener(NBDrag.event.STOP_DRAG,function(){(!e.S.hitTest(e.paper)||NBPoint.distance(e.refn,e.S)>instance.const.NS_DISTANCE)&&(NBDrag.removeDrag(e.S),TweenMax.to(e.S,.5,{x:i,y:o,onComplete:function(){NBDrag.addDrag(e.S)}})),e.stepComplete0&&e.stepComplete1&&e.compass.hit&&(instance.NBDownTipsError.showTip("步骤二已完成"),e.complete=!0,instance.NBStepsShow(!0,2))}),e.N.addEventListener(NBDrag.event.STOP_DRAG,function(){(!e.N.hitTest(e.paper)||NBPoint.distance(e.refs,e.N)>instance.const.NS_DISTANCE)&&(NBDrag.removeDrag(e.N),TweenMax.to(e.N,.5,{x:t,y:a,onComplete:function(){NBDrag.addDrag(e.N)}}))}),e.S.addEventListener(NBDrag.event.DRAG_MOVE,function(){NBPoint.distance(e.refn,e.S)<instance.const.NS_DISTANCE&&(e.refn.x=s,e.refs.x=r,NBDrag.removeDrag(e.N),NBDrag.removeDrag(e.S),TweenMax.to(e.N,.5,{x:i,y:o,onComplete:function(){NBDrag.addDrag(e.N)}}),TweenMax.to(e.S,.5,{x:t,y:a,onComplete:function(){NBDrag.addDrag(e.S),t=e.N.x,a=e.N.y,i=e.S.x,o=e.S.y,s=e.refs.x,r=e.refn.x,e.stepComplete1=!0,e.stepComplete0&&e.stepComplete1&&e.compass.hit&&(e.complete=!0,instance.NBStepsShow(!0,2))}}))}),e.N.addEventListener(NBDrag.event.DRAG_MOVE,function(){NBPoint.distance(e.N,e.refs)<instance.const.NS_DISTANCE&&(e.refs.x=r,e.refn.x=s,NBDrag.removeDrag(e.N),NBDrag.removeDrag(e.S),TweenMax.to(e.N,.5,{x:i,y:o,onComplete:function(){NBDrag.addDrag(e.N)}}),TweenMax.to(e.S,.5,{x:t,y:a,onComplete:function(){NBDrag.addDrag(e.S),t=e.N.x,a=e.N.y,i=e.S.x,o=e.S.y,s=e.refs.x,r=e.refn.x,e.stepComplete1=!0}}),e.stepComplete0&&e.stepComplete1&&e.compass.hit&&(e.complete=!0,instance.NBStepsShow(!0,2),e.N.removeChild(c)))})},frame2:function(){instance.NBDownTip.showTip("将卡纸放入水槽中");var e,t=this,a=t.fish;NBDrag.addDrag(t.fish);var i=(100*Math.random()-50)*Math.PI/180;a.rotation=i,a.txt.rotation=-i;var o=(0,n.default)(0,10);function r(n){var i=a.toGlobal({x:0,y:0});TweenMax.killTweensOf(t.fish),e=Math.atan2(n.data.global.y-i.y,n.data.global.x-i.x),a.addEventListener(TouchEvent.TOUCH_MOVE,s),a.addEventListener(TouchEvent.TOUCH_END,d),a.addEventListener(TouchEvent.TOUCH_END_OUDSIDE,d),a.removeChild(o)}function s(t){var n=a.toGlobal({x:0,y:0}),i=Math.atan2(t.data.global.y-n.y,t.data.global.x-n.x);a.rotation+=i-e,e=i}function d(){a.rotation=a.rotation%(2*Math.PI),a.rotation<-Math.PI/2&&(a.rotation+=2*Math.PI),a.rotation<3*Math.PI/2&&a.rotation>Math.PI&&(a.rotation-=2*Math.PI),TweenMax.to(t.fish,6,{rotation:Math.PI}),a.removeListener(TouchEvent.TOUCH_MOVE,s),a.removeListener(TouchEvent.TOUCH_END,d),a.removeListener(TouchEvent.TOUCH_END_OUDSIDE,d)}a.addChild(o),a.fishTap=o,t.fish.addEventListener(NBDrag.event.START_DRAG,function(){instance.NBDownTip.hideTip()}),t.fish.addEventListener(NBDrag.event.STOP_DRAG,function(){t.fish.hitTest(t.waterRef)?(NBDrag.removeDrag(t.fish),TweenMax.to(t.fish,.5,{x:t.water.x,y:t.water.y-$s(336),onComplete:function(){TweenMax.to(t.fish,6,{rotation:Math.PI}),t.setChildIndex(a,t.children.length-1),a.addEventListener(TouchEvent.TOUCH_BEGIN,r),a.addChild(o),t.hit=!0,instance.NBDownTip.showTip("拖拽卡纸可以旋转方向")}})):(instance.NBDownTip.showTip("将卡纸放入水槽中"),a.addChild(a.fishTap))}),t.waterRef.addEventListener(TouchEvent.TAP,function(){t.hit||instance.NBDownTip.showTip("将卡纸放入水槽中")}),t.fish.addEventListener(NBDrag.event.DRAG_MOVE,function(){a.fishTap&&a.removeChild(o)}),this.onUpdate=function(){}},start:function(){this.menu.addStepFromObj(this.info),this.menu.setExperimentName(this.info.labName),this.bindScriptToSprite(this.frame0,"frame0"),this.bindScriptToSprite(this.frame1,"frame1"),this.bindScriptToSprite(this.frame2,"frame2")},info:{experimentImport:"做好一个标准的指南针必须具备4个条件：磁针、盒子、支架、方向盘。下面我们一起动手制作简易指南针。",labName:"做一个指南针",title0:"磁化缝衣针",title1:"判断磁针的南北极",title2:"使磁针可以自由旋转",OPERATION_0:"",CONCLUSION:"做好一个指南针只需要注意: <br/>1、磁化磁针 <br/>2、判断磁化的南北极 <br/> 3、使磁针可以自由旋转"},const:{START_ROTATION:Math.PI/2,rect:{x:$s(200),y:$s(1200),w:$s(800),h:$s(100)},DISTANCE:190,NS_DISTANCE:60},event:{}}),e.exports=nb.substance0019},520:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={event:{CLICK_NODE:"nodeTap",CLICK_NODE_REACHED:"nodeTapReached",ON_COMPLETE:"timelineComplete",ON_PLAY:"timelinePlaying",REACHED_NODE:"reachedNode",START_DRAG:"startDrag",DRAGING:"draging",STOP_DRAG:"stopDrag"},init:function(){var e,t,a=this;if(a.bgMask){var i=a.bgMask.getChildAt(0);a.progressBar.mask=i,i.scale.x=0}var o=this.a0.x===this.a1.x?"vertical":"horizontal",r=0,s=[];a.drag.lastPos={x:a.drag.x,y:a.drag.y};for(var d=0;d<int.MAX_VALUE;d++){var h=this["a"+d];if(void 0===h){t="vertical"===o?this["a"+(d-1)].y:this["a"+(d-1)].x,r=d;break}s.push(h),0===d&&(e="vertical"===o?h.y:h.x),h.addEventListener(TouchEvent.TAP,function(){var e=this;"vertical"===o?TweenMax.to(a.drag,.5,{y:this.y}):TweenMax.to(a.drag,.5,{x:this.x,onComplete:function(){a.emit(n.event.CLICK_NODE_REACHED,{index:e.name.substr(1,1)})}}),this.totalFrames&&(s.forEach(function(e){return e.currentFrame=0}),this.currentFrame=1),a.drag.lastPos={x:this.x,y:this.y},a.emit(n.event.CLICK_NODE,{index:this.name.substr(1,1)})})}this.setDrag=function(i){i?(NBDrag.addDrag(a.drag),a.drag.on(NBDrag.event.START_DRAG,function(){var i=(a.drag.x-e)/(t-e);a.emit(n.event.START_DRAG,{time:i})}),a.drag.on(NBDrag.event.DRAG_MOVE,function(){var i=(a.drag.x-e)/(t-e);a.emit(n.event.DRAGING,{time:i})}),a.drag.on(NBDrag.event.STOP_DRAG,function(){var i=(a.drag.x-e)/(t-e);a.emit(n.event.STOP_DRAG,{time:i}),i>=1&&a.emit(n.event.ON_COMPLETE,{time:i})})):NBDrag.removeDrag(a.drag)},a.drag.addEventListener(NBDrag.event.STOP_DRAG,function(){if(!1!==a._align_){var n=r-1;if("vertical"===o){var i=Math.round((this.y-e)/(t-e)*n);i<0&&(i=0)}else{var s=Math.round((this.x-e)/(t-e)*n);s<0&&(s=0)}}}),a.drag.addEventListener(NBDrag.event.DRAG_MOVE,function(){p()});var l=!1;a.drag.constY=a.drag.y;var c,p=function(){a.drag.y=a.drag.constY,a.drag.x>=t&&(a.drag.x=t),a.drag.x<=e&&(a.drag.x=e);var i=(a.drag.x-e)/(t-e);if(i<1){l=!1,a.emit(n.event.ON_PLAY,{time:i});for(var o=0;o<s.length;o++)a.drag.lastPos.x<=s[o].x&&a.drag.x>s[o].x&&a.emit(n.event.REACHED_NODE,{index:o})}else l||(l=!0,a.emit(n.event.ON_COMPLETE,{time:i}));(a.drag.line0&&(a.drag.line0.rotation=1800*i*Math.PI/180,a.drag.line1.rotation=360*i*Math.PI/180),a.bgMask)&&(a.bgMask.getChildAt(0).scale.x=i);a.drag.lastPos={x:a.drag.x,y:a.drag.y}};this.getNodeCount=function(){return r},this.setNodePos=function(e){var t=this["a"+e];"vertical"===o?a.drag.y=t.y:a.drag.x=t.x},nb.MovieClip.ticker.add(function(){a._auto_&&!a.drag.isDragging&&("vertical"===o?a.drag.y+=a._speed_:a.drag.x+=a._speed_,p())}),this.setAutoPlay=function(e,t){this._auto_=e,this._speed_=t||.1},this.setAutoAlign=function(e){this._align_=e},this.setMomentsPause=function(e,t,n){clearTimeout(c),e&&!a.NOTafterStopPlay?(a.setAutoPlay(!1),clearTimeout(c),a.setAutoPlay(!1),c=setTimeout(function(){a.setAutoPlay(!0,n)},t)):a.setAutoPlay(!1)},this.resetTimeline=function(){(this.drag.x=this.bgMask.x,a.bgMask)&&(a.bgMask.getChildAt(0).scale.x=0)}}};t.default=n},521:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e=e||{};var t=this,a=[];n.default.init.apply(this.timeline);for(var i=0;i<this.timeline.getNodeCount();i++){var o=this["step"+i];a.push(o),o.alpha=0,o.visible=!1}var r=this.step0;r.visible=!0,r.alpha=1;var s=0;this.timeline.on(n.default.event.CLICK_NODE,function(n){if(void 0!==n.index&&n.index!=s){var i=e.offset||1200;i=n.index>s?$s(i):-$s(i);var o=void 0!==r.currentX?r.currentX:r.currentX=r.x;TweenMax.to(r,e.oldTm||.6,{x:o+i,alpha:0,onComplete:function(t){t.visible=!1,e.isFix||(t.y=0)},onCompleteParams:[r],ease:Expo.easeOut}),s=n.index,(r=a[s]).visible=!0,o=void 0!==r.currentX?r.currentX:r.currentX=r.x,r.x=o-i,TweenMax.to(r,e.newTm||1,{x:o,alpha:1,ease:Expo.easeOut,onComplete:function(){t.emit(t.boxSwitch_event.CHANGE_COM,{target:r,index:n.index})}})}}),this.addEventListener("render",function(){r.onUpdate&&r.onUpdate()}),t.boxSwitch_event={CHANGE_COM:"changeCom"}};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(520))}});